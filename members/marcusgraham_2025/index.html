<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ethan - The Besties Gang Wiki</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="../../style.css" />
  <script src="../../config.js"></script>
</head>
<body>
  <!-- Member profile pages are public, no login required -->
  
  <div class="bg-blur"></div>
  
  <header class="topbar">
    <div class="logo">
      <img class="logo-badge" src="../../images/logo_thebesties.png" alt="The Besties Logo" />
      <span class="logo-text">The Besties Wiki</span>
    </div>
    <div class="security-badge">üîí Ch√≠nh th·ª©c</div>
    <nav class="nav">
      <div class="nav-dropdown">
        <button class="nav-toggle">
          Danh m·ª•c
          <span class="nav-chevron">ÀÖ</span>
        </button>
        <div class="nav-menu">
          <a href="../../index.html#overview">Gi·ªõi thi·ªáu</a>
          <a href="../../index.html#leader">Leader</a>
          <a href="../../index.html#members">Th√†nh vi√™n</a>
          <a href="../../index.html#discord">Discord</a>
        </div>
      </div>
    </nav>
  </header>

  <main>
    <section class="hero-compact section">
      <div class="section-header">
        <h2 id="memberName">ƒêang t·∫£i...</h2>
        <p id="memberSubtitle">Trang h·ªì s∆° chi ti·∫øt v·ªÅ th√†nh vi√™n.</p>
      </div>

      <div class="member-profile-layout" style="margin-top:18px;">
        <aside class="member-profile-meta">
          <div class="avatar-large" id="memberAvatar" style="width:96px;height:96px;border-radius:999px;background:linear-gradient(135deg, #ff5faf, #ff2b8a);display:flex;align-items:center;justify-content:center;color:white;font-size:48px;font-weight:bold;">
            ?
          </div>
          <h3 class="member-profile-role" id="memberNameSidebar">ƒêang t·∫£i...</h3>

          <div class="member-profile-info">
            <div>
              <dt>Vai tr√≤</dt>
              <dd id="memberRole">Th√†nh vi√™n Gang</dd>
            </div>
            <div>
              <dt>Gia nh·∫≠p</dt>
              <dd id="memberJoined">2025</dd>
            </div>
            <div>
              <dt>Tr·∫°ng th√°i</dt>
              <dd>Ho·∫°t ƒë·ªông</dd>
            </div>
          </div>
        </aside>

        <div class="member-profile-content">
          <h3>Gi·ªõi thi·ªáu</h3>
          <p id="memberBio">
            ƒêang t·∫£i th√¥ng tin...
          </p>

          <section style="margin-top:18px;" id="memberDetailsSection">
            <h4>Th√¥ng tin Chi ti·∫øt</h4>
            <p id="memberCharacter">
              <strong>Nh√¢n v·∫≠t:</strong> <span id="characterValue">ƒêang t·∫£i...</span>
            </p>
            <p id="memberBioDetail" style="display:none;">
              <strong>Ti·ªÉu s·ª≠:</strong> <span id="bioValue"></span>
            </p>
          </section>

          <section style="margin-top:24px;" id="gallerySection">
            <h4>H√¨nh ·∫£nh & Kho·∫£nh kh·∫Øc</h4>
            <div class="member-gallery" id="memberGallery">
              <!-- Gallery images loaded dynamically -->
            </div>
          </section>

          <section style="margin-top:24px;">
            <a href="../../dashboard/member-dashboard.html" class="btn primary">Ch·ªânh s·ª≠a h·ªì s∆°</a>
            <a href="../../index.html#members" class="btn ghost" style="margin-left:8px;">Quay l·∫°i danh s√°ch</a>
          </section>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>
      The Besties Gang ‚Ä¢ FiveM  
      <span class="footer-sub">M√†u h·ªìng nh∆∞ng kh√¥ng y·∫øu ƒëu·ªëi.</span>
    </p>
  </footer>

  <script>
    // Load member profile data
    (function() {
      const API_URL = window.APP_CONFIG?.API_URL || (window.location.hostname === 'localhost' ? 'http://localhost:5000/api' : 'https://thebesties-backend.onrender.com/api');
      const folderName = 'marcusgraham_2025'; // Get from current path
      
      async function loadMemberProfile() {
        try {
          // Try to load from API
          const response = await fetch(`${API_URL}/leader/public/members?t=${Date.now()}`);
          if (response.ok) {
            const data = await response.json();
            const member = data.members?.find(m => m.folder === folderName);
            if (member) {
              displayMember(member);
              return;
            }
          }
        } catch (error) {
          console.warn('API failed, trying fallback:', error);
        }
        
        // Fallback: Try static JSON
        try {
          const fallbackResponse = await fetch('../../data/members.json?t=' + Date.now());
          if (fallbackResponse.ok) {
            const fallbackData = await fallbackResponse.json();
            const member = fallbackData.members?.find(m => m.folder === folderName);
            if (member) {
              displayMember(member);
              return;
            }
          }
        } catch (error) {
          console.error('Fallback failed:', error);
        }
        
        // Default fallback data
        displayMember({
          name: 'Ethan',
          character: 'Th√†nh vi√™n Gang',
          bio: 'Th√†nh vi√™n c·ªßa The Besties Gang',
          folder: folderName
        });
      }
      
      function displayMember(member) {
        const name = member.name || 'Th√†nh vi√™n';
        const firstLetter = name.charAt(0).toUpperCase();
        
        // Update title
        document.getElementById('memberName').textContent = `${name} ‚Ä¢ H·ªì s∆° th√†nh vi√™n`;
        document.getElementById('memberSubtitle').textContent = `Trang h·ªì s∆° chi ti·∫øt v·ªÅ th√†nh vi√™n ${name}.`;
        document.getElementById('memberNameSidebar').textContent = name;
        
        // Update avatar
        const avatarEl = document.getElementById('memberAvatar');
        const avatarUrl = member.discordAvatar || `images/avatar.png`;
        avatarEl.innerHTML = '';
        avatarEl.style.backgroundImage = `url('${avatarUrl}')`;
        avatarEl.style.backgroundSize = 'cover';
        avatarEl.style.backgroundPosition = 'center';
        avatarEl.addEventListener('error', function() {
          this.style.backgroundImage = '';
          this.style.background = 'linear-gradient(135deg, #ff5faf, #ff2b8a)';
          this.textContent = firstLetter;
        });
        
        // Update role
        document.getElementById('memberRole').textContent = member.character || 'Th√†nh vi√™n Gang';
        document.getElementById('characterValue').textContent = member.character || 'Ch∆∞a c·∫≠p nh·∫≠t';
        
        // Update joined year
        if (member.createdAt) {
          const year = new Date(member.createdAt).getFullYear();
          document.getElementById('memberJoined').textContent = year;
        }
        
        // Update bio
        if (member.bio) {
          document.getElementById('memberBio').textContent = member.bio;
          document.getElementById('bioValue').textContent = member.bio;
          document.getElementById('memberBioDetail').style.display = 'block';
        } else {
          document.getElementById('memberBio').textContent = 'Th√†nh vi√™n c·ªßa The Besties Gang.';
        }
        
        // Load gallery images
        loadGalleryImages();
      }
      
      function loadGalleryImages() {
        const gallery = document.getElementById('memberGallery');
        const images = [];
        
        // Try to load photo1.png, photo2.png, etc.
        for (let i = 1; i <= 5; i++) {
          const img = document.createElement('figure');
          img.className = 'member-photo';
          const imgEl = document.createElement('img');
          imgEl.src = `images/photo${i}.png`;
          imgEl.alt = `Kho·∫£nh kh·∫Øc ${i}`;
          imgEl.addEventListener('error', function() {
            img.style.display = 'none';
          });
          const caption = document.createElement('figcaption');
          caption.textContent = 'Kho·∫£nh kh·∫Øc';
          img.appendChild(imgEl);
          img.appendChild(caption);
          gallery.appendChild(img);
        }
      }
      
      // Load profile when page loads
      loadMemberProfile();
    })();
  </script>
</body>
</html>